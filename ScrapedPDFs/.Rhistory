element$doubleclick()
remDr$screenshot(display = TRUE)
element$click()
remDr$screenshot(display = TRUE)
element$clickElement()
remDr$screenshot(display = TRUE)
element$sendKeysToElement(list("7"))
remDr$screenshot(display = TRUE)
element$clearElement()
element$clickElement()
element$sendKeysToElement(list("07251985"))
remDr$screenshot(display = TRUE)
element$clearElement()
element$clickElement()
element$sendKeysToElement(list("0" = "0", "7" = "7", "2" = "2", "5" = "5", "1" = "1", "9" = "9", "8" = "8", "5" = "5"))
remDr$screenshot(display = TRUE)
element$clearElement()
element$clickElement()
remDr$screenshot(display = TRUE)
remDr$screenshot(display = TRUE)
element$clickElement()
remDr$screenshot(display = TRUE)
element <- remDr$findElement(using = "xpath",
dobXPath)
element$clearElement()
element$clickElement()
remDr$screenshot(display = TRUE)
element$sendKeysToElement(list("0", "7", "2", "5", "1", "9", "8", "5"))
remDr$screenshot(display = TRUE)
system('docker run -d -p 4446:4444 selenium/standalone-chrome')
system('docker run -d -p 4447:4444 selenium/standalone-chrome')
source("/Users/sgb/Dropbox/R/CourtDocketReader/BETA/DocketScraperUtils.R")
remDr <- RSelenium::remoteDriver(remoteServerAddr = "localhost",
port = 4447L,
browserName = "chrome")
remDr$open()
remDr$navigate("https://ujsportal.pacourts.us/DocketSheets/CP.aspx")
remDr$screenshot(display = TRUE)
parentNode <- "#ctl00_ctl00_ctl00_cphMain_cphDynamicContent_cphDynamicContent_"
searchTypeNode <- paste0(parentNode, "searchTypeListControl")
searchTypes <- xml2::read_html(remDr$getPageSource()[[1]]) %>%
rvest::html_nodes(searchTypeNode) %>%
rvest::html_children() %>%
rvest::html_text() %>%
dplyr::data_frame(searchType = .)
numOfSearchTypes <- 7
searchTypes <- searchTypes %>%
dplyr::mutate(listPosition = 1:numOfSearchTypes,
x = paste0(searchTypeNode,
" > option:nth-child(",
listPosition, ")"))
selectedTypeIndex <- grep("Participant Name",
searchTypes$searchType,
ignore.case = T)
remDr$findElement(using = 'css selector',
searchTypes$x[selectedTypeIndex])$clickElement()
Sys.sleep(1)
parentNode <- paste0(parentNode, "participantCriteriaControl_")
countyNode <- paste0(parentNode, "countyListControl")
counties <- xml2::read_html(remDr$getPageSource()[[1]]) %>%
rvest::html_nodes(countyNode) %>%
rvest::html_children() %>%
rvest::html_text() %>%
dplyr::data_frame(county = .)
numOfCounties <- 68
counties <- counties %>%
dplyr::mutate(listPosition = 1:numOfCounties,
x = paste0(countyNode,
" > option:nth-child(",
listPosition, ")"))
selectedCountyIndex <- grep("Philadelphia",
counties$county,
ignore.case = T)
remDr$findElement(using = 'css selector',
counties$x[selectedCountyIndex])$clickElement()
Sys.sleep(1)
lastName <- "Brooks"
lastNameNode <- paste0(parentNode, "lastNameControl")
element <- remDr$findElement(using = "css selector",
lastNameNode)
element$clearElement()
element$sendKeysToElement(list(lastName))
firstName <- "Steven"
firstNameNode <- paste0(parentNode, "firstNameControl")
element <- remDr$findElement(using = "css selector",
firstNameNode)
element$clearElement()
element$sendKeysToElement(list(firstName))
remDr$screenshot(display = TRUE)
dobNode <- paste0(parentNode, "dateOfBirthControl_DateTextBox")
dobXPath <- '//*[@id="ctl00_ctl00_ctl00_cphMain_cphDynamicContent_cphDynamicContent_participantCriteriaControl_dateOfBirthControl_DateTextBox"]'
element <- remDr$findElement(using = "xpath",
dobXPath)
element$clearElement()
element$clickElement()
remDr$screenshot(display = TRUE)
element$sendKeysToElement(list("0"))
remDr$screenshot(display = TRUE)
element$clearElement()
element$clickElement()
element$sendKeysToElement(list("0"))
remDr$screenshot(display = TRUE)
element$clearElement()
element$clickElement()
remDr$screenshot(display = TRUE)
element$mouseMoveToLocation()
element <- remDr$findElement(using = "xpath",
dobXPath)
element$mouseMoveToLocation()
element <- remDr$findElement(using = "xpath",
dobXPath)
element$field()
element$field(name = "text")
element$field(name = "type")
element$field(name = "value")
element$isElementSelected()
element <- remDr$findElement(using = "xpath",
dobXPath)
element$clearElement()
element$clickElement()
element$isElementSelected()
element$sendKeysToElement(list("0"))
remDr$screenshot(display = TRUE)
element$isElementSelected()
element$sendKeysToElement(list("0", "1"))
remDr$screenshot(display = TRUE)
element <- remDr$findElement(using = "xpath",
dobXPath)
element$clearElement()
element$clickElement()
dob <- strsplit("07251985", split = "")[[1]]
for (i in seq_along(dob)) {
element$sendKeysToElement(list((dob[i])))
}
remDr$screenshot(display = TRUE)
remDr$navigate("https://ujsportal.pacourts.us/DocketSheets/CP.aspx")
remDr$screenshot(display = TRUE)
parentNode <- "#ctl00_ctl00_ctl00_cphMain_cphDynamicContent_cphDynamicContent_"
searchTypeNode <- paste0(parentNode, "searchTypeListControl")
searchTypes <- xml2::read_html(remDr$getPageSource()[[1]]) %>%
rvest::html_nodes(searchTypeNode) %>%
rvest::html_children() %>%
rvest::html_text() %>%
dplyr::data_frame(searchType = .)
numOfSearchTypes <- 7
searchTypes <- searchTypes %>%
dplyr::mutate(listPosition = 1:numOfSearchTypes,
x = paste0(searchTypeNode,
" > option:nth-child(",
listPosition, ")"))
selectedTypeIndex <- grep("Participant Name",
searchTypes$searchType,
ignore.case = T)
remDr$findElement(using = 'css selector',
searchTypes$x[selectedTypeIndex])$clickElement()
Sys.sleep(1)
parentNode <- paste0(parentNode, "participantCriteriaControl_")
countyNode <- paste0(parentNode, "countyListControl")
counties <- xml2::read_html(remDr$getPageSource()[[1]]) %>%
rvest::html_nodes(countyNode) %>%
rvest::html_children() %>%
rvest::html_text() %>%
dplyr::data_frame(county = .)
numOfCounties <- 68
counties <- counties %>%
dplyr::mutate(listPosition = 1:numOfCounties,
x = paste0(countyNode,
" > option:nth-child(",
listPosition, ")"))
selectedCountyIndex <- grep("Philadelphia",
counties$county,
ignore.case = T)
remDr$findElement(using = 'css selector',
counties$x[selectedCountyIndex])$clickElement()
Sys.sleep(1)
dob <- strsplit("07251985", split = "")[[1]]
dobNode <- paste0(parentNode, "dateOfBirthControl_DateTextBox")
dobXPath <- '//*[@id="ctl00_ctl00_ctl00_cphMain_cphDynamicContent_cphDynamicContent_participantCriteriaControl_dateOfBirthControl_DateTextBox"]'
element <- remDr$findElement(using = "xpath",
dobXPath)
element$clearElement()
element$clickElement()
for (i in seq_along(dob)) {
element$sendKeysToElement(list((dob[i])))
}
remDr$screenshot(display = TRUE)
element$clearElement()
element$clickElement()
remDr$screenshot(display = TRUE)
?setCursorPosition
?RSelenium
element$describeElement()
element <- remDr$findElement(using = "xpath",
dobXPath)
element$clearElement()
element$clickElement()
element$sendKeysToElement("{BACKSPACE}")
element$clearElement()
element$clickElement()
element$sendKeysToElement("{BACK}")
element$sendKeysToElement(list("{BACK}"))
element$clearElement()
element$clickElement()
element$sendKeysToElement(list("{BACK}"))
remDr$screenshot(display = TRUE)
element$sendKeysToElement(list("{BACK}"))
remDr$screenshot(display = TRUE)
element$sendKeysToElement(list("{BACKSPACE}"))
remDr$screenshot(display = TRUE)
element$sendKeysToElement(list("7"))
remDr$screenshot(display = TRUE)
element$sendKeysToElement(list("{BACKSPACE}"))
remDr$screenshot(display = TRUE)
element$sendKeysToElement(list("{BACK}"))
remDr$screenshot(display = TRUE)
element$sendKeysToElement(list("{TAB}"))
remDr$screenshot(display = TRUE)
element <- remDr$findElement(using = "xpath",
dobXPath)
element$clearElement()
element$clickElement()
element$sendKeysToElement(list("{{BACKSPACE}}"))
remDr$screenshot(display = TRUE)
element$sendKeysToElement(list("7"))
remDr$screenshot(display = TRUE)
element$sendKeysToElement(list("{{BACKSPACE}}"))
remDr$screenshot(display = TRUE)
element <- remDr$findElement(using = "xpath",
dobXPath)
element$clearElement()
element$clickElement()
element$sendKeysToElement(list("\uE012"))
element$sendKeysToElement(list("7"))
remDr$screenshot(display = TRUE)
replicate()
?replicate()
rep()
?do.call
element <- remDr$findElement(using = "xpath",
dobXPath)
element$clearElement()
element$clickElement()
for (i in 1:4) {element$sendKeysToElement(list("\uE012"))}
for (i in seq_along(dob)) {
element$sendKeysToElement(list((dob[i])))
}
remDr$screenshot(display = TRUE)
element$clearElement()
element$clickElement()
for (i in 1:5) {element$sendKeysToElement(list("\uE012"))}
for (i in seq_along(dob)) {
element$sendKeysToElement(list((dob[i])))
}
remDr$screenshot(display = TRUE)
lastName <- "Brooks"
lastNameNode <- paste0(parentNode, "lastNameControl")
element <- remDr$findElement(using = "css selector",
lastNameNode)
element$clearElement()
element$sendKeysToElement(list(lastName))
firstName <- "Steven"
firstNameNode <- paste0(parentNode, "firstNameControl")
element <- remDr$findElement(using = "css selector",
firstNameNode)
element$clearElement()
element$sendKeysToElement(list(firstName))
element <- remDr$findElement(using = "css selector",
dobNode)
element$clearElement()
element$clickElement()
for (i in 1:5) {element$sendKeysToElement(list("\uE012"))}
for (i in seq_along(dob)) {element$sendKeysToElement(list((dob[i])))}
remDr$screenshot(display = TRUE)
searchNode <- paste0(parentNode, "searchCommandControl")
remDr$findElement(using = "css selector", searchNode)$clickElement()
Sys.sleep(1)
searchResultsPage <- xml2::read_html(remDr$getPageSource()[[1]])
tableXPath <- '//*[@id="ctl00_ctl00_ctl00_cphMain_cphDynamicContent_cphDynamicContent_participantCriteriaControl_searchResultsGridControl_resultsPanel"]/table'
searchResults <- searchResultsPage %>%
rvest::html_node(xpath = tableXPath) %>%
rvest::html_table(fill = T)
searchResultsPage
searchResultsPage <- xml2::read_html(remDr$getPageSource()[[1]])
searchResultsPage
element$clearElement()
element <- remDr$findElement(using = "css selector",
dobNode)
element$clearElement()
searchNode <- paste0(parentNode, "searchCommandControl")
remDr$findElement(using = "css selector", searchNode)$clickElement()
Sys.sleep(1)
searchResultsPage <- xml2::read_html(remDr$getPageSource()[[1]])
tableXPath <- '//*[@id="ctl00_ctl00_ctl00_cphMain_cphDynamicContent_cphDynamicContent_participantCriteriaControl_searchResultsGridControl_resultsPanel"]/table'
searchResults <- searchResultsPage %>%
rvest::html_node(xpath = tableXPath) %>%
rvest::html_table(fill = T)
searchResults <- cleanTable(searchResults)
getSearchResults_Secondary <- function(pageElement) {
remDr$findElement(using = "css selector", pageElement)$clickElement()
Sys.sleep(1)
searchResultsPage <- xml2::read_html(remDr$getPageSource()[[1]])
searchResults <- searchResultsPage %>%
rvest::html_node(xpath = tableXPath) %>%
rvest::html_table(fill = T)
searchResults <- cleanTable(searchResults)
return(searchResults)
}
searchPagesNode <- paste0(parentNode, "searchResultsGridControl_casePager")
searchPages <- xml2::read_html(remDr$getPageSource()[[1]]) %>%
rvest::html_nodes(searchPagesNode) %>%
rvest::html_children() %>%
rvest::html_text()
searchPages <- stringr::str_extract_all(searchPages, "[2-9]*")
searchPages <- searchPages[[1]][searchPages[[1]]!=""]
hasMorePages <- !is.na(searchPages)
if (hasMorePages) {
secondaryPages <- dplyr::data_frame(
pageNumber = 1:length(searchPages) + 1,
pageElement = paste0(searchPagesNode,
" > div > a:nth-child(",
pageNumber + 2, ")"))
secondaryPages <- secondaryPages[,2]
secondaryResults <- purrr::pmap(secondaryPages, getSearchResults_Secondary) %>%
dplyr::bind_rows()
searchResults <- dplyr::bind_rows(searchResults, secondaryResults)
}
is.na(searchPages)
searchPages
searchPages[1]
is.na(searchPages)[1]
getSearchResults <- function(pageElement) {
remDr$findElement(using = "css selector", pageElement)$clickElement()
Sys.sleep(1)
searchResultsPage <- xml2::read_html(remDr$getPageSource()[[1]])
searchResults <- searchResultsPage %>%
rvest::html_node(xpath = tableXPath) %>%
rvest::html_table(fill = T)
searchResults <- cleanTable(searchResults)
return(searchResults)
}
remDr$screenshot(display = TRUE)
searchNode <- paste0(parentNode, "searchCommandControl")
tableXPath <- '//*[@id="ctl00_ctl00_ctl00_cphMain_cphDynamicContent_cphDynamicContent_participantCriteriaControl_searchResultsGridControl_resultsPanel"]/table'
searchResults <- getSearchResults(searchNode, tableXPath)
getSearchResults <- function(pageElement, tableXPath) {
remDr$findElement(using = "css selector", pageElement)$clickElement()
Sys.sleep(1)
searchResultsPage <- xml2::read_html(remDr$getPageSource()[[1]])
searchResults <- searchResultsPage %>%
rvest::html_node(xpath = tableXPath) %>%
rvest::html_table(fill = T)
searchResults <- cleanTable(searchResults)
return(searchResults)
}
searchResults <- getSearchResults(searchNode, tableXPath)
View(searchResults)
rownames(searchResults)
rownames(searchResults) <- 1:nrow(searchResults)
rownames(searchResults)
cleanTable <- function(searchResults) {
nthRow <- 7
searchResults <- searchResults[seq(1, nrow(searchResults), nthRow), ]
columnNames <- names(searchResults)[2:11]
searchResults <- searchResults[,8:17]
names(searchResults) <- columnNames
rownames(searchResults) <- 1:nrow(searchResults)
return(searchResults)
}
searchResults <- getSearchResults(searchNode, tableXPath)
searchPagesNode <- paste0(parentNode, "searchResultsGridControl_casePager")
searchPages <- xml2::read_html(remDr$getPageSource()[[1]]) %>%
rvest::html_nodes(searchPagesNode) %>%
rvest::html_children() %>%
rvest::html_text()
searchPages <- stringr::str_extract_all(searchPages, "[2-9]*")
searchPages <- searchPages[[1]][searchPages[[1]]!=""]
hasMorePages <- !is.na(searchPages)[1]
if (hasMorePages) {
secondaryPages <- dplyr::data_frame(
pageNumber = 1:length(searchPages) + 1,
pageElement = paste0(searchPagesNode,
" > div > a:nth-child(",
pageNumber + 2, ")"))
secondaryPages <- secondaryPages[,2]
secondaryResults <- purrr::pmap(secondaryPages, getSearchResults_Secondary) %>%
dplyr::bind_rows()
searchResults <- dplyr::bind_rows(searchResults, secondaryResults)
}
View(searchResults)
if (hasMorePages) {
secondaryPages <- dplyr::data_frame(
pageNumber = 1:length(searchPages) + 1,
pageElement = paste0(searchPagesNode,
" > div > a:nth-child(",
pageNumber + 2, ")"))
secondaryPages <- secondaryPages[,2]
secondaryResults <- purrr::pmap(secondaryPages, getSearchResults) %>%
dplyr::bind_rows()
searchResults <- dplyr::bind_rows(searchResults, secondaryResults)
}
if (hasMorePages) {
secondaryPages <- dplyr::data_frame(
pageNumber = 1:length(searchPages) + 1,
pageElement = paste0(searchPagesNode,
" > div > a:nth-child(",
pageNumber + 2, ")"))
secondaryPages <- secondaryPages[,2]
secondaryResults <- purrr::pmap(secondaryPages, getSearchResults(tableXPath = tableXPath)) %>%
dplyr::bind_rows()
searchResults <- dplyr::bind_rows(searchResults, secondaryResults)
}
if (hasMorePages) {
secondaryPages <- dplyr::data_frame(
pageNumber = 1:length(searchPages) + 1,
pageElement = paste0(searchPagesNode,
" > div > a:nth-child(",
pageNumber + 2, ")"))
secondaryPages <- secondaryPages[,2]
secondaryResults <- purrr::pmap(secondaryPages,
getSearchResults(pageElement = secondaryPages,
tableXPath = tableXPath)) %>%
dplyr::bind_rows()
searchResults <- dplyr::bind_rows(searchResults, secondaryResults)
}
searchNode <- paste0(parentNode, "searchCommandControl")
tableXPath <- '//*[@id="ctl00_ctl00_ctl00_cphMain_cphDynamicContent_cphDynamicContent_participantCriteriaControl_searchResultsGridControl_resultsPanel"]/table'
searchResults <- getSearchResults(searchNode, tableXPath)
searchPagesNode <- paste0(parentNode, "searchResultsGridControl_casePager")
searchPages <- xml2::read_html(remDr$getPageSource()[[1]]) %>%
rvest::html_nodes(searchPagesNode) %>%
rvest::html_children() %>%
rvest::html_text()
searchPages <- stringr::str_extract_all(searchPages, "[2-9]*")
searchPages <- searchPages[[1]][searchPages[[1]]!=""]
hasMorePages <- !is.na(searchPages)[1]
if (hasMorePages) {
secondaryPages <- dplyr::data_frame(
pageNumber = 1:length(searchPages) + 1,
pageElement = paste0(searchPagesNode,
" > div > a:nth-child(",
pageNumber + 2, ")"))
secondaryPages <- secondaryPages[,2]
secondaryResults <- purrr::pmap(secondaryPages,
getSearchResults(pageElement = secondaryPages,
tableXPath = tableXPath)) %>%
dplyr::bind_rows()
searchResults <- dplyr::bind_rows(searchResults, secondaryResults)
}
secondaryResults <- purrr::pmap(secondaryPages,
getSearchResults(secondaryPages,
tableXPath)) %>%
secondaryResults <- purrr::pmap(secondaryPages,
getSearchResults(secondaryPages,
tableXPath)) %>%
dplyr::bind_rows()
if (hasMorePages) {
secondaryPages <- dplyr::data_frame(
pageNumber = 1:length(searchPages) + 1,
pageElement = paste0(searchPagesNode,
" > div > a:nth-child(",
pageNumber + 2, ")"))
secondaryPages <- secondaryPages[,2]
secondaryResults <- purrr::map(secondaryPages, getSearchResults(secondaryPages, tableXPath)) %>%
dplyr::bind_rows()
searchResults <- dplyr::bind_rows(searchResults, secondaryResults)
}
searchPagesNode <- paste0(parentNode, "searchResultsGridControl_casePager")
searchPages <- xml2::read_html(remDr$getPageSource()[[1]]) %>%
rvest::html_nodes(searchPagesNode) %>%
rvest::html_children() %>%
rvest::html_text()
searchPages <- stringr::str_extract_all(searchPages, "[2-9]*")
searchPages <- searchPages[[1]][searchPages[[1]]!=""]
hasMorePages <- !is.na(searchPages)[1]
searchPages
secondaryPages <- dplyr::data_frame(
pageNumber = 1:length(searchPages) + 1,
pageElement = paste0(searchPagesNode,
" > div > a:nth-child(",
pageNumber + 2, ")"))
secondaryPages
secondaryPages <- secondaryPages[,2]
secondaryPages
secondaryResults <- purrr::pmap(secondaryPages, getSearchResults) %>%
dplyr::bind_rows()
getSearchResults <- function(pageElement, tableXPath = NULL) {
remDr$findElement(using = "css selector", pageElement)$clickElement()
Sys.sleep(1)
searchResultsPage <- xml2::read_html(remDr$getPageSource()[[1]])
searchResults <- searchResultsPage %>%
rvest::html_node(xpath = tableXPath) %>%
rvest::html_table(fill = T)
searchResults <- cleanTable(searchResults)
return(searchResults)
}
secondaryResults <- purrr::pmap(secondaryPages, getSearchResults) %>%
dplyr::bind_rows()
getSearchResults <- function(pageElement) {
remDr$findElement(using = "css selector", pageElement)$clickElement()
Sys.sleep(1)
searchResultsPage <- xml2::read_html(remDr$getPageSource()[[1]])
searchResults <- searchResultsPage %>%
rvest::html_node(xpath = tableXPath) %>%
rvest::html_table(fill = T)
searchResults <- cleanTable(searchResults)
return(searchResults)
}
secondaryResults <- purrr::pmap(secondaryPages, getSearchResults) %>%
dplyr::bind_rows()
searchResults <- dplyr::bind_rows(searchResults, secondaryResults)
View(searchResults)
View(searchResults)
